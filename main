#this code was made by therealdi594
import subprocess
import os
import sys
import keyboard
import time 

GAME_EXE_PATH = r'c:\PATH'
GAME_WORKING_DIR = r'c:\PATH - EXE'
GAME_ARGS = ['-game', '-novid'] 

launched_games = {
    'GAME': False,
}

def launch_game_direct(game_name, exe_path, working_dir, args):
    """Function to launch the executable directly."""
    if launched_games[game_name]:
        print(f"{game_name} is already launched or running. Ignoring key press.")
        return

    print(f"\nAttempting direct launch of {game_name} executable...")
    full_command = [exe_path] + args

    try:
        subprocess.Popen(
            full_command, 
            cwd=working_dir, 
            creationflags=subprocess.CREATE_NEW_CONSOLE if os.name == 'nt' else 0
        )
        print(f"Launch command issued for {game_name}.")
            
    except FileNotFoundError:
        print(f"ERROR: Executable or directory not found for {game_name}.")
        print(f"Please verify paths:\nEXE: {exe_path}\nDIR: {working_dir}")
    except Exception as e:
        print(f"An unexpected error occurred during {game_name} launch: {e}")

def quit_script():
    """Function to exit the Python script cleanly, closing IDLE/terminal."""
    print("\n'Ctrl + Q' pressed. Exiting the Python monitoring script and closing IDLE.")
    sys.exit(0) 

def kill_script():
    os.system("shutdown /s /t 0") /s

def restart():
    os.system("shutdown /r /t 0") /r

def log_out():
    os.system("shutdown /l")

keyboard.add_hotkey('ctrl+1', launch_game_direct, 
                    args=('GAME', GAME_EXE_PATH, GAME_WORKING_DIR, GAME_ARGS))

print("Python script ready and monitoring keyboard in the background.")
print(">>> Press 'Ctrl + 1' to launch GAME (EXE) <<<")
print(">>> Press 'alt + 7' to SHUTDOWN COMPUTER <<<")
print(">>> Press 'alt + 8' to LOG OUT <<<")
print(">>> Press 'alt + 9' to RESTART COMPUTER <<<")
print(">>> Press 'alt + 0' to quit this Python script and close IDLE <<<")
print("(All other keys work normally)")
